<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Diálogos</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            overflow: hidden;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .scene-area {
            flex: 1;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 50px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.1), rgba(0,0,0,0.3));
        }

        .character {
            width: 300px;
            height: 400px;
            position: relative;
            transition: all 0.5s ease;
            cursor: pointer;
        }

        .character.speaking {
            transform: scale(1.1);
            filter: brightness(1.2) contrast(1.1);
            z-index: 10;
        }

        .character.inactive {
            filter: brightness(0.4) contrast(0.8);
            transform: scale(0.95);
        }

        .character-image {
            width: 100%;
            height: 100%;
            border-radius: 15px;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            object-fit: cover;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #999;
        }

        .character.speaking .character-image {
            border-color: #ffd700;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
        }

        .character-name {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }

        .dialogue-box {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: linear-gradient(145deg, rgba(20,20,40,0.95), rgba(40,40,80,0.95));
            border: 2px solid #ffd700;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .speaker-name {
            color: #ffd700;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .dialogue-text {
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 15px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.7);
        }

        .dialogue-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .next-button {
            background: linear-gradient(145deg, #ffd700, #ffed4e);
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
        }

        .next-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(255, 215, 0, 0.4);
        }

        .dialogue-counter {
            color: #aaa;
            font-size: 14px;
        }

        .controls-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
            font-size: 12px;
        }

        .expression-controls {
            margin-top: 10px;
        }

        .expression-btn {
            background: #444;
            color: white;
            border: none;
            padding: 5px 10px;
            margin: 2px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 11px;
        }

        .expression-btn:hover {
            background: #666;
        }

        .add-dialogue-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        .typewriter {
            overflow: hidden;
            white-space: nowrap;
            animation: typing 0.05s steps(1, end);
        }

        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="scene-area">
            <div class="character" id="character1">
                <img class="character-image" src="pngwing.com.png" alt="Personaje 1" />
                <div class="character-name">Personaje 1</div>
            </div>
            
            <div class="character" id="character2">
                <img class="character-image" src="sebas.jpeg" alt="Personaje 2" />
                <div class="character-name">Personaje 2</div>
            </div>
        </div>

        <div class="dialogue-box" id="dialogueBox" style="display: none;">
            <div class="speaker-name" id="speakerName"></div>
            <div class="dialogue-text" id="dialogueText"></div>
            <div class="dialogue-controls">
                <div class="dialogue-counter" id="dialogueCounter"></div>
                <button class="next-button" id="nextButton">Siguiente</button>
            </div>
        </div>

        <div class="controls-panel">
            <div><strong>Controles del Sistema</strong></div>
            <div>Personaje 1:</div>
            <div class="expression-controls">
                <button class="expression-btn" onclick="changeExpression('character1', 'normal')">Normal</button>
                <button class="expression-btn" onclick="changeExpression('character1', 'happy')">Feliz</button>
                <button class="expression-btn" onclick="changeExpression('character1', 'sad')">Triste</button>
            </div>
            <div>Personaje 2:</div>
            <div class="expression-controls">
                <button class="expression-btn" onclick="changeExpression('character2', 'normal')">Normal</button>
                <button class="expression-btn" onclick="changeExpression('character2', 'happy')">Feliz</button>
                <button class="expression-btn" onclick="changeExpression('character2', 'sad')">Triste</button>
            </div>
            <button class="add-dialogue-btn" onclick="startDialogue()">Iniciar Diálogo</button>
            <button class="add-dialogue-btn" onclick="addCustomDialogue()">Agregar Diálogo</button>
        </div>
    </div>

    <script>
        // Sistema de personajes y expresiones
        const characters = {
            character1: {
                name: "Ana",
                expressions: {
                    normal: "", // Aquí pondrías las URLs de las imágenes
                    happy: "",
                    sad: ""
                },
                currentExpression: "normal"
            },
            character2: {
                name: "Carlos",
                expressions: {
                    normal: "",
                    happy: "",
                    sad: ""
                },
                currentExpression: "normal"
            }
        };

        // Sistema de diálogos
        let dialogues = [
            {
                speaker: "character1",
                text: "¡Hola! ¿Cómo estás hoy?",
                expression: "happy"
            },
            {
                speaker: "character2", 
                text: "¡Muy bien, gracias por preguntar! ¿Y tú?",
                expression: "happy"
            },
            {
                speaker: "character1",
                text: "Estoy un poco preocupada por el examen de mañana...",
                expression: "sad"
            },
            {
                speaker: "character2",
                text: "¡No te preocupes! Estoy seguro de que lo harás genial.",
                expression: "normal"
            }
        ];

        let currentDialogueIndex = 0;
        let isTyping = false;

        // Funciones del sistema
        function changeExpression(characterId, expression) {
            const character = characters[characterId];
            if (character && character.expressions[expression] !== undefined) {
                character.currentExpression = expression;
                const img = document.querySelector(`#${characterId} .character-image`);
                
                // Si hay imagen configurada, la usa, si no muestra placeholder
                if (character.expressions[expression]) {
                    img.src = character.expressions[expression];
                    img.alt = `${character.name} - ${expression}`;
                } else {
                    img.innerHTML = `${character.name}<br>${expression.toUpperCase()}`;
                }
            }
        }

        function setSpeaker(characterId) {
            // Resetear todos los personajes
            document.querySelectorAll('.character').forEach(char => {
                char.classList.remove('speaking', 'inactive');
            });

            // Configurar el personaje que habla
            const speakingChar = document.getElementById(characterId);
            if (speakingChar) {
                speakingChar.classList.add('speaking');
                
                // Los demás personajes se vuelven inactivos
                document.querySelectorAll('.character').forEach(char => {
                    if (char.id !== characterId) {
                        char.classList.add('inactive');
                    }
                });
            }
        }

        function typeText(text, element, callback) {
            if (isTyping) return;
            
            isTyping = true;
            element.innerHTML = '';
            let i = 0;
            
            const typeInterval = setInterval(() => {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                } else {
                    clearInterval(typeInterval);
                    isTyping = false;
                    if (callback) callback();
                }
            }, 30);
        }

        function showDialogue(dialogue) {
            const dialogueBox = document.getElementById('dialogueBox');
            const speakerName = document.getElementById('speakerName');
            const dialogueText = document.getElementById('dialogueText');
            const dialogueCounter = document.getElementById('dialogueCounter');
            const nextButton = document.getElementById('nextButton');

            // Configurar personaje que habla
            setSpeaker(dialogue.speaker);
            changeExpression(dialogue.speaker, dialogue.expression);

            // Mostrar información del diálogo
            speakerName.textContent = characters[dialogue.speaker].name;
            dialogueCounter.textContent = `${currentDialogueIndex + 1} / ${dialogues.length}`;
            
            // Efecto de escritura
            typeText(dialogue.text, dialogueText, () => {
                nextButton.style.opacity = '1';
                nextButton.disabled = false;
            });

            dialogueBox.style.display = 'flex';
            nextButton.style.opacity = '0.5';
            nextButton.disabled = true;
        }

        function nextDialogue() {
            if (isTyping) return;
            
            currentDialogueIndex++;
            
            if (currentDialogueIndex < dialogues.length) {
                showDialogue(dialogues[currentDialogueIndex]);
            } else {
                endDialogue();
            }
        }

        function endDialogue() {
            document.getElementById('dialogueBox').style.display = 'none';
            document.querySelectorAll('.character').forEach(char => {
                char.classList.remove('speaking', 'inactive');
            });
            currentDialogueIndex = 0;
        }

        function startDialogue() {
            if (dialogues.length > 0) {
                currentDialogueIndex = 0;
                showDialogue(dialogues[currentDialogueIndex]);
            }
        }

        function addCustomDialogue() {
            const speaker = prompt("¿Quién habla? (character1 o character2):");
            const text = prompt("¿Qué dice?:");
            const expression = prompt("¿Qué expresión? (normal, happy, sad):");
            
            if (speaker && text && expression && characters[speaker]) {
                dialogues.push({
                    speaker: speaker,
                    text: text,
                    expression: expression
                });
                alert("¡Diálogo agregado!");
            }
        }

        // API para desarrolladores
        window.DialogueSystem = {
            // Configurar personajes
            setCharacter: function(characterId, name, expressions) {
                if (characters[characterId]) {
                    characters[characterId].name = name;
                    characters[characterId].expressions = expressions;
                    document.querySelector(`#${characterId} .character-name`).textContent = name;
                }
            },

            // Agregar diálogos programáticamente
            addDialogue: function(speaker, text, expression = 'normal') {
                dialogues.push({ speaker, text, expression });
            },

            // Limpiar diálogos
            clearDialogues: function() {
                dialogues = [];
                currentDialogueIndex = 0;
            },

            // Iniciar diálogo
            start: startDialogue,

            // Cambiar expresión
            setExpression: changeExpression
        };

        // Event listeners
        document.getElementById('nextButton').addEventListener('click', nextDialogue);

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            // Mostrar placeholders iniciales
            changeExpression('character1', 'normal');
            changeExpression('character2', 'normal');
        });

        // Ejemplo de uso con imágenes reales (descomenta cuando tengas las imágenes)
        /*
        DialogueSystem.setCharacter('character1', 'Ana', {
            normal: 'path/to/ana_normal.png',
            happy: 'path/to/ana_happy.png',
            sad: 'path/to/ana_sad.png'
        });

        DialogueSystem.setCharacter('character2', 'Carlos', {
            normal: 'path/to/carlos_normal.png',
            happy: 'path/to/carlos_happy.png',
            sad: 'path/to/carlos_sad.png'
        });
        */
    </script>
</body>
</html>